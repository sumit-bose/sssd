<?xml version="1.0"?>

<!DOCTYPE busconfig PUBLIC
 "-//freedesktop//DTD D-BUS Bus Configuration 1.0//EN"
 "http://www.freedesktop.org/standards/dbus/1.0/busconfig.dtd">

<busconfig>

  <!-- This configuration file specifies the required security policies
       for the oddjob_sss_get_keytab_principals service to work. It controls
       which requests users will be allowed to issue to oddjobd over the bus,
       which is quite different from controlling whether or not oddjobd will
       attempt to fulfill the request. -->

  <!-- Only root can own (provide) the com.redhat.oddjob_sss_get_keytab_principals
       service on the system bus. -->
  <policy user="root">
    <allow own="com.redhat.oddjob_sss_get_keytab_principals"/>
  </policy>

  <!-- Allow anyone to call the introspection methods of any object
       provided by the com.redhat.oddjob_sss_get_keytab_principals service. -->
  <policy context="default">
    <allow send_destination="com.redhat.oddjob_sss_get_keytab_principals"
           send_interface="org.freedesktop.DBus.Introspectable"/>
  </policy>

  <!-- Allow anyone to try to call the sss_get_keytab_principals method, which
       is part of the "sss_get_keytab_principals" interface implemented by the
       "/" object provided by the com.redhat.oddjob_sss_get_keytab_principals
       service. -->
  <policy context="default">
    <allow send_destination="com.redhat.oddjob_sss_get_keytab_principals"
           send_path="/"
           send_interface="com.redhat.oddjob_sss_get_keytab_principals"
           send_member="sss_get_keytab_principals"/>
  </policy>

</busconfig>
